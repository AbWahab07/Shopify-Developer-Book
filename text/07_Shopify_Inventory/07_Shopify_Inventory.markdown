## Shopify Inventory

When working out a development plan for a merchant's shop the inventory setup should come first and the theme should come last. Unfortunately many merchants jump into a theme only to realize later that while it looked good in theory, the reality is much different with their actual inventory. To achieve success a shop needs to present inventory in a way that complements a smooth shopping experience and that it is not gimmicks that sell. Sometimes deeper thinking about how a product and it's variants, pricing, images and options will dictate the best presentation and process. If the inventory is not organized correctly a lot of effort can be wasted trying to fix a theme up. 

A product requires at a minimum only a title. The title will then be turned into a unique *handle* that is a reference to the product in the shop. A quick example is a product with the title **Quick Brown Fox**. Shopify will set a handle to this product as **quick-brown-fox** and the product will then be found online as the shop's URL appended with _/products/quick-brown-fox_. With no further action from a merchant a new product has been created and added to inventory with a zero dollar price, infinite inventory for sale, no tags, images, description or other useful attributes. It exists for the purposes of showing up on the site and can be accessed with an API call using the handle or ID it was assigned. You can *always* get the ID of a product simply by looking at the URL in the shop admin for the product when editing it. An example would be /admin/products/90368349 where the _903368349_ is the unique ID for the product. As long as that product exists in the shop that number will never change. It is used during import and export operations to identify products that will need to be updated. It is also handy to use that number when quickly checking out a product with the API. For example perhaps we want to quickly see if a product has any metafields. A very quick but effective command-line effort would be:

<div class="figure">
<img src="file://localhost/Users/dlazar/Pictures/Shopify%20E-Book/api%20call2.png" alt="Example API Call" />
</div>

With just a couple of keystrokes we found a product and we are able to see that it has no metafield resources attached to it. 

When setting up a product in inventory we can edit the variant and provide a title for the variant as well as it's price, SKU and inventory management policy. Shopify also provides three options that can be assigned to a variant. If a product has a colour, size and material they can be accommodated as options. These options could be anything so there is a fair amount of flexibility in using them. A product with attributes like density, plasticity, taste, style, or even chemical composition could be setup. Assuming all three options are used Shopify allows a product up to 100 variants. This means a product with five colours, four sizes and three materials would require 5 times 4 times 3 or 60 variants. Each one counts as an SKU in Shopify for the pricing plan selected. It is not necessary to assign an SKU to each variant, and you can assign the same SKU to as many variants as needed. Shopify simply treats the SKU as an attribute with no special meaning. Using the Shopify Ajax API it is very simple to use the handle of a product to get all of it's attributes. If we open up a store that has a version of the API code rendered as part of the theme, we can use the developer tools of our browser to inspect the details.

<div class="figure">
<img src="file://localhost/Users/dlazar/Pictures/Shopify%20E-Book/ajax%20product2.png" alt="Getting Product Info using Ajax" />
</div>

An examination of the object representing a Shopify product shows us the structure of a product's options and how they are responsible for attributes generated for each variant. We can use this to completely customize the way Shopify renders products and variants. Many shops use the code Shopify provides to render each option as a separate HTML select element instead of one select element with each element separated with slashes. When a selection is made, a callback is triggered with the variant and that allows a shop to update things like pricing and availability. It is simple, reliable and it works. It can be relied on by developers to take front-end shop development to the next level beyond those basics. 

If there are images uploaded for a product it is possible to detect images that might match the SKU assigned to the variant or perhaps the variant title. It is easy to make up some rules dictating how images that are uploaded for a product are coded so that code can be used in the callback logic. 

A pattern I have used successfully to bring to life shops with clickable image swatches that change the variant, loading new sets of thumbnails, and allowing a mix of select elements with color swatches is to simply add a small script library to the shop containing code to work with the options. I let the default Shopify code **option_selectors.js** run knowing it will setup the HTML select elements and wire up whatever callback I want. I hide all the select elements Shopify generated. I modify the callback to run any extra code I may need to ensure smooth operations with the selections. Since I hid the HTML select elements, I run code that renders images or color swatches representing the variants. Each set of thumbnails or color swatches is assigned a click listener and that is the key to ensuring the right variant is selected. A click on an image that represents the product with the style "faux beaver fur" can trigger the change event on the hidden HTML select element setting it to the value "faux beaver fur" and the callback function will be called with the correct variant. Fabulous and simple. Clicks on an image can be so much more intuitive than selecting text from a drop down element. Perhaps the product has not only faux beaver fur but also an option called colour represented by clickable colour boxes. A click on any of the colour boxes would be recognized as **blue**, **red** or perhaps **green**. We could change the background colour of the main image to match. Or we could load new images of the product with "beaver faux fur" colourized to match. 

Knowing how Shopify inventory works with respect to variants and options is crucial to building out shops with advanced capabilities. To take a shop to a level where shoppers can easily add the product of their choice into the cart and buy it without guesswork or too much reading is essential. Knowing that you can upload as many images of a product as you want does not make it easy to swap the images when options are selected. One technique is to use the Shopify administration interface to add text to product image alt attributes. Those should be used for improving SEO but they can also be used to make a primitive image swapper work. For example, if the alt tag was set to a color that matched the variant title, you could swap the image currently visible with one that matches color wise when a variant change is detected. A more sophisticated approach would be to examine the name of the image itself. Basic regular expressions can be used to parse a filename into all of it's parts. That might be **white_lily_formica_solipstic_grande.jpeg** where you can decide that the click was on a *white lily* colored *formica solipstic* variant and that the image is Shopify grande in size. Now, with a tiny bit of code, you could substitute the image uploaded as **black_lily_formica_solipstic.jpeg** and you could set the size to medium using the source **black_lily_formica_solipstic_medium.jpeg**.

Sometimes you have to present a list of colours but the sizes should remain as an HTML select element. Don't hide the select element for size changes. Be aware that when showing and hiding elements like the ones Shopify renders in their option_selectors.js file, that they are using a numbering scheme derived from the representation of the product object too. If there are three options, they are listed as option1, option2, option3 and that you might have the actual options in an array where option[0] is option1, coming from a click on a select element with the DOM ID product-select-option-0 depending on how you called the select element in your theme (in this case ID was product-select).

In summary, it is possible to present your Products in Shopify with pretty amazing effects triggered by clicks on elements other then HTML select elements, while maintaing control over the current variant, meaning you can update prices and keep the add to cart action enabled or disabled depending on inventory settings. 